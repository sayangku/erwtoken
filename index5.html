<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Music Collection</title>
    <style>
        /* CSS stilleri burada kalabilir */
    </style>
</head>
<body>
    <h1>My Music Collection</h1>

    <form id="linkForm">
        <input type="text" id="nameInput" placeholder="Şarkı adı" required>
        <input type="url" id="linkInput" placeholder="YouTube video linki" required>
        <button type="submit">Ekle</button>
    </form>
    
    <ul id="linkList"></ul>

    <div id="playerContainer" class="player-container" style="display: none;">
        <div class="player-header">
            <p class="player-title" id="currentSong">Şarkı Adı</p>
            <button class="minimize-btn" id="minimizeBtn">▼</button>
        </div>
        <div class="player-content" id="playerContent">
            <!-- iframe buraya gelecek -->
        </div>
    </div>

    <script>
        const playerContainer = document.getElementById('playerContainer');
        const playerContent = document.getElementById('playerContent');
        const minimizeBtn = document.getElementById('minimizeBtn');
        const currentSong = document.getElementById('currentSong');
        
        let currentVideoId = null;

        function extractVideoId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function createPlayer(videoId, songName) {
            const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&enablejsapi=1&origin=${window.location.origin}`;
            playerContent.innerHTML = `<iframe src="${embedUrl}" allowfullscreen></iframe>`;
            currentSong.textContent = songName;
            playerContainer.style.display = 'block';
            currentVideoId = videoId;

            // Ekranın kapanmasını önlemek için fonksiyonu çağır
            preventScreenSleep();
        }

        function preventScreenSleep() {
            const video = document.querySelector('iframe');
            if (video) {
                video.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
            }
        }

        // Ekran kapandığında videoyu durdurmamak için belirli aralıklarla fonksiyonu çağırın
        setInterval(preventScreenSleep, 10000); // Her 10 saniyede bir kontrol et

        minimizeBtn.addEventListener('click', () => {
            playerContainer.classList.toggle('minimized');
            minimizeBtn.textContent = playerContainer.classList.contains('minimized') ? '▲' : '▼';
        });

        const form = document.getElementById('linkForm');
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('nameInput').value.trim();
            const link = document.getElementById('linkInput').value.trim();
            
            if (name && link) {
                const videoId = extractVideoId(link);
                if (videoId) {
                    createPlayer(videoId, name);
                } else {
                    alert('Geçersiz YouTube linki');
                }
                document.getElementById('nameInput').value = '';
                document.getElementById('linkInput').value = '';
            }
        });
    </script>
</body>
</html>
